<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Qu·∫£n l√Ω S√°ch</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
        }
        h2 {
            margin-top: 20px;
        }
        table {
            border-collapse: collapse;
            width: 600px;
            margin: 20px auto;
        }
        th, td {
            border: 1px solid black;
            padding: 6px;
            text-align: center;
        }
        th {
            background-color: #f0f0f0;
        }
        .buttons {
            margin-top: 10px;
        }
        .buttons button {
            margin: 5px;
            padding: 6px 10px;
        }
    </style>
</head>
<body>
    <h2>Qu·∫£n l√≠ s√°ch</h2>

    <table id="bangSach">
        <thead>
            <tr>
                <th>M√£ s·ªë s√°ch</th>
                <th>T√™n s√°ch</th>
                <th>NƒÉm xu·∫•t b·∫£n</th>
                <th>S·ªë quy·ªÉn</th>
                <th>T√¨nh tr·∫°ng</th>
            </tr>
        </thead>
        <tbody>
        </tbody>
    </table>

    <div class="buttons">
        <button onclick="themSachDaCo()">Th√™m s√°ch ƒë√£ c√≥</button>
        <button onclick="themSachMoi()">Th√™m s√°ch m·ªõi</button>
        <button onclick="muonSach()">M∆∞·ª£n s√°ch</button>
        <button onclick="hienThiSachNhieuNhat()">Hi·ªÉn th·ªã s√°ch nhi·ªÅu nh·∫•t</button>
    </div>

    <script>
        let danhSachSach = [
            { ma: "12345", ten: "To√°n", nam: 2000, soQuyen: 3, tinhTrang: true },
            { ma: "23456", ten: "VƒÉn", nam: 1998, soQuyen: 4, tinhTrang: true },
            { ma: "37456", ten: "Ti·∫øng Anh", nam: 1999, soQuyen: 0, tinhTrang: false }
        ];

        function capNhatTinhTrang(sach) {
            sach.tinhTrang = sach.soQuyen > 0;
        }

        function hienThiDanhSach() {
            const tbody = document.querySelector("#bangSach tbody");
            tbody.innerHTML = "";
            for (let s of danhSachSach) {
                let row = document.createElement("tr");
                row.innerHTML = `
                    <td>${s.ma}</td>
                    <td>${s.ten}</td>
                    <td>${s.nam}</td>
                    <td>${s.soQuyen}</td>
                    <td>${s.tinhTrang ? "True" : "False"}</td>
                `;
                tbody.appendChild(row);
            }
        }

        function themSachMoi() {
            let ma;
            do {
                ma = prompt("Nh·∫≠p m√£ s√°ch (1xxxx - 5xxxx):");
            } while (!/^[1-5][0-9]{4}$/.test(ma));

            let ten;
            do {
                ten = prompt("Nh·∫≠p t√™n s√°ch:");
            } while (!ten || ten.trim() === "");

            let nam;
            do {
                nam = prompt("Nh·∫≠p nƒÉm xu·∫•t b·∫£n (4 ch·ªØ s·ªë):");
            } while (!/^\d{4}$/.test(nam));

            let soQuyen;
            do {
                soQuyen = parseInt(prompt("Nh·∫≠p s·ªë quy·ªÉn:"));
            } while (isNaN(soQuyen) || soQuyen < 0);

            let tinhTrang = soQuyen > 0;

            danhSachSach.push({
                ma: ma,
                ten: ten,
                nam: nam,
                soQuyen: soQuyen,
                tinhTrang: tinhTrang
            });

            hienThiDanhSach();
            alert("‚úÖ Th√™m s√°ch m·ªõi th√†nh c√¥ng!");
        }

        function themSachDaCo() {
            let ma = prompt("Nh·∫≠p m√£ s√°ch c·∫ßn tƒÉng s·ªë l∆∞·ª£ng:");
            let sach = danhSachSach.find(s => s.ma === ma);
            if (sach) {
                let soThem = parseInt(prompt("Nh·∫≠p s·ªë l∆∞·ª£ng mu·ªën th√™m:"));
                if (!isNaN(soThem) && soThem > 0) {
                    sach.soQuyen += soThem;
                    capNhatTinhTrang(sach);
                    hienThiDanhSach();
                    alert("‚úÖ C·∫≠p nh·∫≠t th√†nh c√¥ng!");
                } else {
                    alert("‚ùå S·ªë l∆∞·ª£ng kh√¥ng h·ª£p l·ªá!");
                }
            } else {
                alert("‚ùå Kh√¥ng t√¨m th·∫•y m√£ s√°ch!");
            }
        }

        function muonSach() {
            let ma = prompt("Nh·∫≠p m√£ s√°ch c·∫ßn m∆∞·ª£n:");
            let sach = danhSachSach.find(s => s.ma === ma);
            if (sach) {
                if (sach.soQuyen > 0) {
                    sach.soQuyen--;
                    capNhatTinhTrang(sach);
                    hienThiDanhSach();
                    alert("‚úÖ M∆∞·ª£n s√°ch th√†nh c√¥ng!");
                } else {
                    alert("‚ùå S√°ch ƒë√£ h·∫øt!");
                }
            } else {
                alert("‚ùå Kh√¥ng t√¨m th·∫•y m√£ s√°ch!");
            }
        }

        function hienThiSachNhieuNhat() {
            if (danhSachSach.length === 0) return;
            let max = Math.max(...danhSachSach.map(s => s.soQuyen));
            let sachMax = danhSachSach.filter(s => s.soQuyen === max);
            let tenSach = sachMax.map(s => s.ten).join(", ");
            alert(`üìö S√°ch c√≥ s·ªë l∆∞·ª£ng nhi·ªÅu nh·∫•t (${max} quy·ªÉn): ${tenSach}`);
        }

        hienThiDanhSach();
    </script>
</body>
</html>
